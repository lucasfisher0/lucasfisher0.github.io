<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Heartbeat Synth | A Shady Place</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Heartbeat Synth" />
<meta name="author" content="GitHub User" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Some time ago, I came upon a MATLAB script that can synthesize a heartbeat sound. Could this be used in real-time, to generate a dynamic heartbeat for the current situation? Without access to MATLAB’s DSP functionality, it’s time to try an Unreal implementation." />
<meta property="og:description" content="Some time ago, I came upon a MATLAB script that can synthesize a heartbeat sound. Could this be used in real-time, to generate a dynamic heartbeat for the current situation? Without access to MATLAB’s DSP functionality, it’s time to try an Unreal implementation." />
<meta property="og:site_name" content="A Shady Place" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-05-03T00:00:00-06:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Heartbeat Synth" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"GitHub User"},"dateModified":"2025-05-03T00:00:00-06:00","datePublished":"2025-05-03T00:00:00-06:00","description":"Some time ago, I came upon a MATLAB script that can synthesize a heartbeat sound. Could this be used in real-time, to generate a dynamic heartbeat for the current situation? Without access to MATLAB’s DSP functionality, it’s time to try an Unreal implementation.","headline":"Heartbeat Synth","mainEntityOfPage":{"@type":"WebPage","@id":"/ue5/audio/2025/05/03/heartbeat-synth.html"},"url":"/ue5/audio/2025/05/03/heartbeat-synth.html"}</script>
<!-- End Jekyll SEO tag -->
<link id="main-stylesheet" rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="A Shady Place" />

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Barrio&display=swap" rel="stylesheet"></head>
<body><header class="site-header">

  <div class="wrapper">
    <a class="site-title" rel="author" href="/">A Shady Place</a>
      <nav class="site-nav">
        <input type="checkbox" id="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon"></span>
        </label>

        <div class="nav-items">
  <a class="nav-item" href="/about/">About</a>
  <a class="nav-item" href="/cat/">Categories</a>
  <a class="nav-item" href="/latest/">Latest</a>
</div>

      </nav>
  </div>

<div id="lightPull">
  <canvas id="lightPullCanvas" width="160" height="175"></canvas>
</div>

<script>
  const metaTag = document.getElementById("main-stylesheet");
  let SSHref = metaTag.href;
  let SSName = SSHref.substring(SSHref.lastIndexOf('/') + 1);
  let prevSkin = localStorage.getItem("minima-ss");

  if (prevSkin)
    metaTag.href = SSHref.replace(SSName, prevSkin);
  else
    changeSkin("dark.css")

  function changeSkin(_ssName) {
    metaTag.href = SSHref.replace(SSName, _ssName);
    localStorage.setItem("minima-ss", _ssName);
  }
</script>

<script>
  class Point {
    constructor(x, y) {
      this.x = x;
      this.y = y;
      this.startX = x;
      this.startY = y;
      this.oldX = x;
      this.oldY = y;
      this.pinned = false;
    }

    update(deltaTime) {
      let velocityX = (this.x - this.oldX);
      let velocityY = (this.y - this.oldY);

      this.oldX = this.x;
      this.oldY = this.y;
      this.x += velocityX;
      this.y += velocityY;

      this.y += gravity * deltaTime * deltaTime;
    }
  }

  class Stick {
    constructor(pointA, pointB, length) {
      this.pointA = pointA;
      this.pointB = pointB;
      this.length = length;
    }

    constrain() {
      let dx = this.pointB.x - this.pointA.x;
      let dy = this.pointB.y - this.pointA.y;
      let distance = Math.sqrt(dx * dx + dy * dy);
      if (distance > segmentMaxLength)
        distance = segmentMaxLength;
      let difference = this.length - distance;

      let percent = difference / distance / 2;
      let offsetX = dx * percent;
      let offsetY = dy * percent;

      if (!this.pointA.pinned) {
        this.pointA.x -= offsetX;
        this.pointA.y -= offsetY;

      }
      if (!this.pointB.pinned) {
        this.pointB.x += offsetX;
        this.pointB.y += offsetY;
      }
    }

    reverseConstrain() {
      let dx = this.pointA.x - this.pointb.x;
      let dy = this.pointA.y - this.pointb.y;
      let distance = Math.sqrt(dx * dx + dy * dy);
      if (distance > segmentMaxLength)
        distance = segmentMaxLength;
      let difference = this.length - distance;

      let percent = difference / distance / 2;
      let offsetX = dx * percent;
      let offsetY = dy * percent;

      if (!this.pointB.pinned) {
        this.pointB.x -= offsetX;
        this.pointB.y -= offsetY;
      }
      if (!this.pointA.pinned) {
        this.pointA.x += offsetX;
        this.pointA.y += offsetY;
      }
    }
  }

  const canvas = document.getElementById('lightPullCanvas');
  const ctx = canvas.getContext('2d');

  /* Don't look at any of this, it was all an exercise in procrastination and is really sloppy.
  I am honored to waste your CPU to make this a reality. */
  
  let clearNavbox = false;
  function WidthChange(mq) {
    clearNavbox = mq.matches;
  }

  const navbox = document.getElementsByClassName('site-nav').item(0);
  let mq = window.matchMedia("(max-width: 600px)");
  mq.addListener(WidthChange);
  WidthChange(mq);

  const points = [];
  const sticks = [];
  const numPoints = 6;
  const beadRadius = 4;
  const segmentLength = 15;
  const segmentMaxLength = 35;
  const gravity = 10;
  const iterations = 5;

  const startX = (canvas.clientWidth / 2) + 10;

  let lastTime = 0;
  let timeSincePull = 0;
  let sleep = true;

  for (let i = 0; i < numPoints; i++) {
    points.push(new Point(startX, 5 + i * segmentLength));
  }

  for (let i = 0; i < numPoints - 1; i++) {
    sticks.push(new Stick(points[i], points[i + 1], segmentLength));
  }

  let activePull = false;
  let pullPoint = new Point(0, 0);
  let mousePoint = new Point(0, 0);
  let pullForce = new Stick(points[points.length - 1], pullPoint, 0);
  let mouseForce = new Stick(pullPoint, mousePoint, 5);

  points[0].pinned = true;
  mousePoint.pinned = true;

  function isTouchEventWithElement(e) {
    const item = e.changedTouches.item(0);
    if (canvas === null || item === null) return false;
    return canvas.getBoundingClientRect().right > item.clientX &&
      canvas.getBoundingClientRect().left < item.clientX &&
      canvas.getBoundingClientRect().top < item.clientY &&
      canvas.getBoundingClientRect().bottom > item.clientY;
  }

  function updateMouse(grabbed) {
    activePull = grabbed;
    sleep = false;
    timeSincePull = 0;
  }

  function updateMousePos(e, isTouch = false) {
    if(!isTouch) {
      mousePoint.x = e.offsetX;
      mousePoint.y = e.offsetY;
      updateMouse(true);
    }
    if(isTouch && isTouchEventWithElement(e)) {
      mousePoint.x = e.changedTouches.item(0).clientX - canvas.getBoundingClientRect().left;
      mousePoint.y = e.changedTouches.item(0).clientY - canvas.getBoundingClientRect().top;
      updateMouse(true);
    }
  }

  function completeTug() {
    if (activePull) {
      activePull = false;
      timeSincePull = 0;

      prevSkin = localStorage.getItem("minima-ss");
      let newSkin = 
        (prevSkin == null || prevSkin != "dark.css")
        ? "dark.css"
        : "style.css";

      changeSkin(newSkin);
      if (window.getSelection)
        window.getSelection().removeAllRanges();
      if (document.selection)
        document.selection.empty();
    }
  }

  // Mouse
  canvas.addEventListener('mousedown', (e) => updateMousePos(e), 0);
  canvas.addEventListener('mouseup', (e) => updateMouse(false), 0);
  canvas.addEventListener('mouseout', completeTug, 0);
  canvas.addEventListener('mousemove', function (e) {
    if (activePull)
      updateMousePos(e);
  }, 0);
  
  // Touchscreen
  canvas.addEventListener('touchstart', (e) => updateMousePos(e, true), 0);
  canvas.addEventListener('touchcancel', updateMouse(false), 0);
  canvas.addEventListener('touchend', (e) => updateMouse(false), 0);
  canvas.addEventListener('touchmove', function (e) {
    if (activePull) {
      if (isTouchEventWithElement(e)) {
        updateMousePos(e, true);
      }
      else
        completeTug();
    }
  }, 0);

  
  function update(deltaTime) {
    if (!activePull) {
      timeSincePull += deltaTime;
      if (timeSincePull > 8) {
        if (!sleep) {
          for (let i = 0; i < numPoints; i++) {
            points[i].x = startX;
            points[i].y = 5 + (i * segmentLength);
          }
          sleep = true;
        }

        return;
      }
      points.forEach((point, pointIx) => {
        point.x = point.x + (startX - point.x) * (timeSincePull / 6.6) * deltaTime;
        point.y = point.y + (((5 + (pointIx * segmentLength)) - point.y) * (timeSincePull / 6.6) * deltaTime);
      });
    }

    points.forEach(point => {
      if (!point.pinned) {
        point.update(deltaTime);
      }
    });

    for (let i = 0; i < 10; i++) {
      for (let ix = 0; ix < sticks.length; ix++) {
        sticks[ix].constrain();

        if (activePull) {
          pullForce.constrain();
          mouseForce.constrain();
        }
      }
      if (activePull) {
        for (let ix = 0; ix < sticks.length; ix++) {
          sticks[sticks.length - ix - 1].constrain();
        }
      }
      else {
        let terminalPoint = points[points.length - 1];
        terminalPoint.x = terminalPoint.x + (startX - terminalPoint.x) * 0.25 * deltaTime;
        terminalPoint.y = terminalPoint.y + ((5 + numPoints * segmentLength) - terminalPoint.y) * 0.25 * deltaTime;
      }
    }
  }

  function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.strokeStyle = window.getComputedStyle(canvas).getPropertyValue('--wire-color');
    ctx.fillStyle = window.getComputedStyle(canvas).getPropertyValue('--bead-color');

    sticks.forEach(stick => {
      ctx.beginPath();
      ctx.moveTo(stick.pointA.x, stick.pointA.y);
      ctx.lineTo(stick.pointB.x, stick.pointB.y);
      ctx.stroke();
    });

    points.forEach(point => {
      ctx.beginPath();
      ctx.arc(point.x, point.y, beadRadius, 0, Math.PI * 2);
      ctx.fill();
    });

    if (clearNavbox) {
      let navLeft = navbox.getBoundingClientRect().left - canvas.getBoundingClientRect().left;
      let navTop = navbox.getBoundingClientRect().top - canvas.getBoundingClientRect().top;
      ctx.clearRect(navLeft, navTop, 500, navbox.getBoundingClientRect().bottom - navbox.getBoundingClientRect().top)
    }
  }

  function loop(time) {
    let deltaTime = (time - lastTime) / 1000;
    lastTime = time;

    if (!sleep) {
      update(deltaTime);
    }
    draw();
    requestAnimationFrame(loop);
  }
  loop(0);
</script>
</header><main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Heartbeat Synth</h1>
    <div class="post-meta">
      <time class="dt-published" datetime="2025-05-03T00:00:00-06:00" itemprop="datePublished">
        May 3, 2025
      </time>
    </div>
  </header>

  <div class="post-content e-content">
    <aside class="post-sidebar sticky">
      <nav class="toc">
        <ul id="toc" class="section-nav">
<li class="toc-entry toc-h2"><a href="#how-the-blood-sausage-is-made">How the Blood-sausage is Made</a></li>
<li class="toc-entry toc-h2"><a href="#unreals-audio-system">Unreal’s Audio System’</a></li>
<li class="toc-entry toc-h2"><a href="#final-result">Final Result</a></li>
</ul>
      </nav>
    </aside>
    <div class="post-text post-main" itemprop="articleBody">
    
      <p>Some time ago, I came upon <a href="https://github.com/bencholmes/heartbeat">a MATLAB script that can synthesize a heartbeat sound</a>. Could this be used in real-time, to generate a dynamic heartbeat for the current situation? Without access to MATLAB’s DSP functionality, it’s time to try an Unreal implementation.</p>

<p>Huge thanks to Ben Holmes for making this script public domain! This project would never have been possible without him.</p>

<h2 id="how-the-blood-sausage-is-made">
<a class="anchor" href="#how-the-blood-sausage-is-made" aria-hidden="true"><span class="octicon octicon-link"></span></a>How the Blood-sausage is Made</h2>
<p><a name="matlab"></a></p>

<p>The original script recreates the sections of the EKG.</p>

<p>The original idea is to recreate the sections of an EKG, then filter these signals to create the distinct sound as you hear it.</p>

<p>but still wanted to play around with this</p>

<p>. Would it even be possible to dynamically generate a pulse within rea</p>

<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Fusce bibendum neque eget nunc mattis eu sollicitudin enim tincidunt. Vestibulum lacus tortor, ultricies id dignissim ac, bibendum in velit.</p>

<h2 id="unreals-audio-system">
<a class="anchor" href="#unreals-audio-system" aria-hidden="true"><span class="octicon octicon-link"></span></a>Unreal’s Audio System’</h2>
<p><a name="unreal"></a></p>

<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Fusce bibendum neque eget nunc mattis eu sollicitudin enim tincidunt. Vestibulum lacus tortor, ultricies id dignissim ac, bibendum in velit.</p>

<h2 id="final-result">
<a class="anchor" href="#final-result" aria-hidden="true"><span class="octicon octicon-link"></span></a>Final Result</h2>
<p><a name="result"></a></p>

<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Fusce bibendum neque eget nunc mattis eu sollicitudin enim tincidunt. Vestibulum lacus tortor, ultricies id dignissim ac, bibendum in velit.</p>

    </div>
  </div>

  <a class="u-url" href="/ue5/audio/2025/05/03/heartbeat-synth.html" hidden></a>
</article>

      </div>
    </main><link id="fa-stylesheet" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css">

<footer class="site-footer h-card">
  <data class="u-url" value="/"></data>

  <div class="wrapper">
    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p>Portfolio, Unreal Tutorials, and various interests.
</p>
      </div>
      <div class="footer-col social-links"><ul class="social-media-list"><li>
    <a rel="me" href="https://github.com/lucasfisher0" target="_blank" title="GitHub">
      <span class="grey fa-brands fa-github fa-lg"></span>
    </a>
  </li><li>
    <a rel="me" href="https://www.linkedin.com/in/lucas-fisher-0aa347135/" target="_blank" title="LinkedIn">
      <span class="grey fa-brands fa-linkedin fa-lg"></span>
    </a>
  </li>
  <li>
    <a href="/feed.xml" target="_blank" title="Subscribe to syndication feed">
      <svg class="svg-icon grey" viewbox="0 0 16 16">
        <path d="M12.8 16C12.8 8.978 7.022 3.2 0 3.2V0c8.777 0 16 7.223 16 16h-3.2zM2.194
          11.61c1.21 0 2.195.985 2.195 2.196 0 1.21-.99 2.194-2.2 2.194C.98 16 0 15.017 0
          13.806c0-1.21.983-2.195 2.194-2.195zM10.606
          16h-3.11c0-4.113-3.383-7.497-7.496-7.497v-3.11c5.818 0 10.606 4.79 10.606 10.607z"
        />
      </svg>
    </a>
  </li>
</ul>
</div>
    </div>
  </div>

</footer>
<div class="sub-footer">
  <span id="sf-toggle" onclick="toggleSubFooter()">
    <span class="sf-toggle-icon"></span>
  </span>
  
  <div id="skin-switch-container">
    <!--
    Page rendered with the <select id="skin-switch">
      <option value="auto.css">auto</option>
      <option value="style.css">classic</option>
      <option value="dark.css">dark</option>
      <option value="solarized-dark.css">solarized-dark</option>
      <option value="solarized-light.css">solarized-light</option>
      <option value="solarized.css">solarized</option>
    </select> skin of Minima theme.
    <i class="fa-regular fa-bell"></i>
  -->
      
      
    <!-- https://docs.fontawesome.com/web/use-with/ruby-on-rails -->
    <div><small id="copyright"></small></div>
  </div>
</div>

<script>
  document.getElementById('copyright').innerHTML = "&copy; " + new Date().getFullYear() + " Lucas Fisher";

  function toggleSubFooter() {
    siteFooter = document.querySelector(".site-footer");
    siteFooter.classList.toggle("sub-footer-hidden");
  }
</script></body>

</html>
